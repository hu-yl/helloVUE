{"remainingRequest":"/Users/huyaolong/Desktop/hello-shop/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huyaolong/Desktop/hello-shop/src/components/pages/CategoryList.vue?vue&type=style&index=0&id=e21a3c52&scoped=true&lang=css&","dependencies":[{"path":"/Users/huyaolong/Desktop/hello-shop/src/components/pages/CategoryList.vue","mtime":1553445387604},{"path":"/Users/huyaolong/Desktop/hello-shop/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/huyaolong/Desktop/hello-shop/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/huyaolong/Desktop/hello-shop/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/huyaolong/Desktop/hello-shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huyaolong/Desktop/hello-shop/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#leftNav{\n    background-color: aliceblue;\n}\n#leftNav ul li {\n    line-height: 2rem;\n    border-bottom: 1px solid #E4E7ED;\n    padding:3px;\n    font-size:0.8rem;\n    text-align: center;\n}\n.categoryActice{\n    background-color: #fff;\n}\n\n\n.list-item{\n    display: flex;\n    flex-direction: row;\n    font-size:0.8rem;\n    border-bottom: 1px solid #f0f0f0;\n    background-color: #fff;\n    padding:5px;\n}\n#list-div{\n    overflow: scroll;\n}\n.list-item-img{\n    flex:8;\n}\n.list-item-text{\n    flex:16;\n    margin-top:10px;\n    margin-left:10px;\n}\n\n",{"version":3,"sources":["CategoryList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CategoryList.vue","sourceRoot":"src/components/pages","sourcesContent":["<template>\n    <div>\n        <div class=\"navbar-div\">\n            <van-nav-bar title=\"类别列表\" />\n        </div>\n\n        <div>\n          <van-row>\n              <van-col span=\"6\">\n                  <div id=\"leftNav\">\n                       <ul>\n                           <li @click=\"clickCategory(index,item.ID)\" :class=\"{categoryActice:categoryIndex==index}\" v-for=\"(item , index) in category\" :key=\"index\">\n                               {{item.MALL_CATEGORY_NAME}}\n                           </li>\n                       </ul>\n                  </div>\n                 \n              </van-col>\n              <van-col span=\"18\">\n\n                  <div class=\"tabCategorySub\">\n                      <van-tabs v-model=\"active\" @click=\"onClickCategorySub\">\n                          <van-tab v-for=\"(item,index) in categorySub\" :key=\"index\" :title=\"item.MALL_SUB_NAME\">\n\n                          </van-tab>\n                      </van-tabs>\n                  </div>\n                  \n                <div id=\"list-div\">\n                    <van-pull-refresh v-model=\"isRefresh\" @refresh=\"onRefresh\">\n                        <van-list v-model=\"loading\" :finished=\"finished\" @load=\"onLoad\">\n                            <div class=\"list-item\" @click=\"goGoodsInfo(item.ID)\" v-for=\"(item,index) in goodList\" :key=\"index\">\n                                <div class=\"list-item-img\">\n                                    <img :src=\"item.IMAGE1\" \n                                    width=\"100%\"\n                                    :onerror=\"errorImg\"                                    \n                                     />\n                                    \n                                    \n                                   \n                                </div>\n                                <div class=\"list-item-text\">\n                                    <div>{{item.NAME}}</div>                                    \n                                    <div>￥{{item.ORI_PRICE | moneyFilter}}</div>                                    \n                                 </div>\n                            </div>\n                        </van-list>\n                    </van-pull-refresh>\n                </div>\n              </van-col>\n          </van-row>  \n        </div>\n\n    </div>\n</template>\n\n<script>\n    import axios from 'axios'\n    import url from '@/serviceAPI.config.js'\n    import {toMoney} from '@/filter/moneyFilter.js'\n    export default {\n        data() {\n            return {\n                category: [],\n                categoryIndex:0,\n                categorySub:[],  //小类类别\n                active:0,    //激活标签的值\n                loading:false,\n                finished:false, //上拉加载是否有数据\n                page:1,        //商品列表的页数\n                goodList:[],   //商品列表信息\n                categorySubId:'', //商品子类ID\n                isRefresh:false, //下拉刷新\n                errorImg:'this.src=\"'+require('@/assets/images/errorimg.png')+'\"',\n            }\n        },\n        filters:{\n            moneyFilter(money){\n                return toMoney(money)\n            }\n        },\n        created(){\n            this.getCategory();\n           \n        },\n        mounted(){\n            let winHeight = document.documentElement.clientHeight\n            document.getElementById(\"leftNav\").style.height=winHeight -46-50 +'px'\n            document.getElementById(\"list-div\").style.height=winHeight -90-50 +'px'\n        },\n        methods: {\n            getCategory() {\n                axios({\n                    url:url.getCateGoryList,\n                    method:'get',\n                })\n                .then(response=>{\n                    console.log(response)\n                    if(response.data.code == 200 && response.data.message ){\n                      this.category = response.data.message\n                      this.getCategorySubByCategoryID(this.category[0].ID)\n                    }else{\n                        Toast('服务器错误，数据取得失败')\n                    }\n                })\n                .catch(error=>{\n                    console.log(error)\n                })\n                \n            },\n            clickCategory(index,categoryId){\n                 \n                this.categoryIndex=index\n                this.page=1\n                this.finished = false\n                this.goodList= [] \n                this.getCategorySubByCategoryID(categoryId)\n            },\n            //根据大类ID读取小类类别列表\n            getCategorySubByCategoryID(categoryId){\n                axios({\n                    url:url.getCateGorySubList,\n                    method:'post',\n                    data:{categoryId:categoryId}\n                })\n                .then(response=>{\n                    console.log(response)\n                    if(response.data.code==200 && response.data.message){\n                        this.categorySub=response.data.message\n                        this.active=0\n                        this.categorySubId = this.categorySub[0].ID\n                        this.onLoad()\n                    }\n                })\n                .catch(error=>{\n                    console.log(error)\n                })\n            },\n            //上拉加载方法\n            onLoad(){\n                setTimeout(()=>{\n                   this.categorySubId = this.categorySubId?this.categorySubId:this.categorySub[0].ID\n                   this.getGoodList()\n                },1000)\n            },\n            //下拉刷新方法\n            onRefresh(){\n                setTimeout(()=>{\n                    this.isRefresh=false;\n                    this.finished = false;\n                    this.goodList=[]\n                    this.page=1\n                    this.onLoad()\n\n                },500)\n            },\n            getGoodList(){\n                axios({\n                    url:url.getGoodsListByCategorySubID,\n                    method:'post',\n                    data:{\n                        categorySubId:this.categorySubId,\n                        page:this.page\n                    }\n                })\n                .then(response=>{\n                    console.log(response)\n                    if(response.data.code == 200  && response.data.message.length){\n                        this.page++\n                        this.goodList=this.goodList.concat(response.data.message)\n                    }else{\n                        this.finished = true\n                    }\n                    this.loading = false;\n                    \n                })\n                .catch(error=>{\n                    console.log(error)\n                })\n            },\n            onClickCategorySub(index,title){\n                this.categorySubId = this.categorySub[index].ID\n                console.log('categorySubId:'+this.categorySubId)\n                this.goodList=[]\n                this.finished = false\n                this.page = 1\n                this.onLoad()\n\n            },\n            //跳转到商品详细页\n            goGoodsInfo(id){\n                this.$router.push({name:'Goods',params:{goodsId:id}})\n            }\n\n          \n\n           \n        },\n    }\n</script>\n\n<style scoped>\n    #leftNav{\n        background-color: aliceblue;\n    }\n    #leftNav ul li {\n        line-height: 2rem;\n        border-bottom: 1px solid #E4E7ED;\n        padding:3px;\n        font-size:0.8rem;\n        text-align: center;\n    }\n    .categoryActice{\n        background-color: #fff;\n    }\n\n\n    .list-item{\n        display: flex;\n        flex-direction: row;\n        font-size:0.8rem;\n        border-bottom: 1px solid #f0f0f0;\n        background-color: #fff;\n        padding:5px;\n    }\n    #list-div{\n        overflow: scroll;\n    }\n    .list-item-img{\n        flex:8;\n    }\n    .list-item-text{\n        flex:16;\n        margin-top:10px;\n        margin-left:10px;\n    }\n   \n</style>"]}]}