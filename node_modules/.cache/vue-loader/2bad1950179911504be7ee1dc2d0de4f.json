{"remainingRequest":"/Users/huyaolong/Desktop/helloVUE/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huyaolong/Desktop/helloVUE/src/components/pages/Login.vue?vue&type=style&index=0&id=409aef44&scoped=true&lang=css&","dependencies":[{"path":"/Users/huyaolong/Desktop/helloVUE/src/components/pages/Login.vue","mtime":1553699901101},{"path":"/Users/huyaolong/Desktop/helloVUE/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/huyaolong/Desktop/helloVUE/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/huyaolong/Desktop/helloVUE/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/huyaolong/Desktop/helloVUE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huyaolong/Desktop/helloVUE/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.register-panel {\n  width: 96%;\n  border-radius: 5px;\n  margin: 20px auto;\n  padding-bottom: 80px;\n}\n.register-button {\n  padding-top: 10px;\n}\n",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components/pages","sourcesContent":["<template>\n  <div>\n    <van-nav-bar title=\"用户登陆\" left-text=\"返回\" left-arrow @click-left=\"goBack\"/>\n    <div class=\"register-panel\">\n      <van-field\n        v-model=\"username\"\n        label=\"用户名\"\n        icon=\"clear\"\n        placeholder=\"请输入用户名\"\n        required\n        @click-icon=\"username=''\"\n        :error-message=\"usernameErrorMsg\"\n      />\n\n      <van-field\n        v-model=\"password\"\n        type=\"password\"\n        label=\"密码\"\n        placeholder=\"请输入密码\"\n        required\n        :error-message=\"passwordErrorMsg\"\n      />\n      <div class=\"register-button\">\n        <van-button type=\"primary\" @click=\"loginAction\" size=\"large\" :loading=\"openLoading\">登陆</van-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport url from \"@/serviceAPI.config.js\";\nimport { Toast } from \"vant\";\nexport default {\n  data() {\n    return {\n      username: \"\",\n      password: \"\",\n      openLoading: false, //是否开启用户注册的Loading状态\n      usernameErrorMsg: \"\", //当用户名出现错误时的提示信息\n      passwordErrorMsg: \"\" //当密码出现错误时的提示信息\n    };\n  },\n   created(){\n            if(localStorage.userInfo){\n                Toast.success('您已经登录过了')\n                this.$router.push('/')\n            }\n        },\n  methods: {\n    goBack() {\n      this.$router.go(-1);\n    },\n    loginAction() {\n      this.checkForm() && this.axiosLoginUser();\n      //如果第一个不为true，第二个不执行\n    },\n\n    axiosLoginUser() {\n      this.openLoading = true;\n      axios({\n        url: url.login,\n        method: \"post\",\n        data: {\n          userName: this.username,\n          password: this.password\n        }\n      })\n        .then(response => {\n          console.log(response);\n          if (response.data.code == 200 && response.data.message) {\n            new Promise((resolve, reject) => {\n              localStorage.userInfo = { userName: this.username };\n              setTimeout(() => {\n                resolve();\n              }, 500);\n            })\n              .then(() => {\n                Toast.success(\"登录成功\");\n                this.$router.push(\"/\");\n              })\n              .catch(err => {\n                Toast.fail(\"登录状态保存失败\");\n                console.log(err);\n              });\n          } else {\n            Toast.fail(\"登录失败\");\n            this.openLoading = false;\n          }\n        })\n        .catch(error => {\n          Toast.fail(\"登录失败\");\n          this.openLoading = false;\n        });\n    },\n    //****表单验证方法\n    checkForm() {\n      let isOk = true;\n      if (this.username.length < 5) {\n        this.usernameErrorMsg = \"用户名不能少于5位\";\n        isOk = false;\n      } else {\n        this.usernameErrorMsg = \"\";\n      }\n      if (this.password.length < 6) {\n        this.passwordErrorMsg = \"密码不能少于6位\";\n        isOk = false;\n      } else {\n        this.passwordErrorMsg = \"\";\n      }\n\n      return isOk;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.register-panel {\n  width: 96%;\n  border-radius: 5px;\n  margin: 20px auto;\n  padding-bottom: 80px;\n}\n.register-button {\n  padding-top: 10px;\n}\n</style>"]}]}